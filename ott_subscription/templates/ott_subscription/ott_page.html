<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OTT Subscription</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <style>
             body {
            font-family: "Montserrat", sans-serif;
    background: linear-gradient(to right, #c7c7c7, #ffffff);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
}
.input-group input::placeholder, button {
    font-family: 'Montserrat', sans-serif;
}
h2{
    margin: 0px 0px 20px 0px;
}
.container {
    background: #fff;
    padding: 20px;
    width: 90%;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    border-radius: 10px;
    text-align: center;
    display: flex;
    flex-direction: column;
    margin: 0 auto;
}

h2 {
    color: #333;
}

.input-group {
    margin: 15px 0;
    text-align: left;
}

.input-group label {
    display: block;
    font-weight: bold;
    margin-bottom: 5px;
    display:none;
}

.input-group input, select {
    width: 100%;
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
    box-sizing: border-box;
    box-shadow: 0px 0px 3px 1px #00000047;
    height: 48px;
}
select
{
    margin: 12px 0px;
}

.button {
    width: auto;
    padding: 14px 30px;
    background: #f00000;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
    transition: 0.3s;
    text-wrap-mode: nowrap;
}

.button:hover {
    background: #00c3ff;
}

#extraContent {
    display: none;
    margin-top: 20px;
    padding: 0px;
    border-top: 2px solid #ddd;
}

#errorMessage {
    color: red;
    font-size: 14px;
    margin-top: 10px;
}
h1 {
    font-size: 17px;
    
    text-align: left;
}
p {
    text-align: left;
    margin: 0px;
}
.info
{
    display: flex;
    justify-content: space-between;
}
.info p {
    margin-bottom: 10px;
    padding: 10px 0px;
    display: flex;
    justify-content: space-between;
    font-size: 14px;
    column-gap:10px;
}
label{
    margin-top: 15px;
}
p.footer {
    font-size: 12px;
    text-align: center;
    display: block;
    line-height: 25px !important;
    margin-top: 11px !important;
}
.form-wrap {
    display: flex;
    align-items: center;
    column-gap: 10px;
    width: 50%;
    margin: 0 auto;
}
.plan-wrap {
    display: flex;
    justify-content: flex-start;
    margin-top: 10px;
    column-gap: 15px;
}
.plan-wrap .plan {
    width: 25%;
    background-color: #e7e6e6;
    border-radius: 10px;
    height: 300px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.plan-wrap .plan { flex-direction: column; row-gap: 10px; position: relative; }
.plan-wrap .plan button { position: absolute; width: 100%; bottom: 0px; }

    </style>
</head>
<body>

   

    <!-- Login Form Section -->
    {% if not contact %}
    <div class="login-form">
        <h3>Login</h3>
        <form method="POST">
            {% csrf_token %}
            <div class="form-group">
                <label for="contact">Enter your Email or Phone Number:</label>
                <input type="text" id="contact" name="contact" placeholder="Email or Phone" required>
            </div>
            <div class="form-group">
                <button type="submit" class="button">Send Verification Code</button>
            </div>
        </form>
        <p>Already have an account? <a href="#">Log In</a></p>
    </div>
    {% endif %}

    <!-- Content Section (Accessible after successful login) -->
    {% if contact %}
    <div class="container">
        <h1>OTT Subscription</h1>
        
            <!-- Display User Information -->
            <div class="info">
              
                <p><span>Name:</span> {{ user.name }}</p>
                <p><span>Phone:</span> {{ user.phone }}</p>
                <p><span>Email:</span> {{ contact }}</p>
                <p><span>Address:</span> {{ user.address }}</p>
                <p><span>Plan:</span> 500Mbps with 8 OTTs</p>
            </div>

          

            <!-- OTT Platform Selection -->
            <label for="ott-platform"><strong>Select Your Preferred OTT Platform:</strong></label>
    
            <!-- Dropdown Selection for OTT Platforms -->
            <form id="platformForm">
                <div class="form-wrap mb-2">
                  
                    <select id="platform" name="platform_id" class="form-select form-select-sm small-width" required onchange="showOtts()">
                        <option value="">Select Platform</option>
                        <option value="watcho">Watcho</option>
                        <option value="play_box">Play Box</option>
                        <option value="hotstar">Hotstar</option>
                        <option value="ottplay">OTTplay</option>
                        <option value="tata_play_binge">Tata Play Binge</option>
                    </select>
                </div>
            </form>
            
                <div id="skylinkPlansList" class="plan-wrap">
                    <!-- Skylink plans will be displayed here based on the platform selection -->
                </div>
       
    </div>
    {% endif %}

    <!-- Bootstrap JS (Optional for interactive components like buttons, etc.) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function showOtts() {
            // Get the selected platform value from the dropdown
            var platformId = document.getElementById('platform').value;
    
            // Check if a platform is selected
            if (platformId) {
                // Make an AJAX request to fetch the Skylink plans for the selected platform
                fetch(`/ott_subscription/get-skylink-plans/?platform_id=${platformId}`)
                    .then(response => response.json())
                    .then(data => {
                        // Get the element where Skylink plans will be displayed
                        var skylinkPlansList = document.getElementById('skylinkPlansList');
    
                        // Clear previous results
                        skylinkPlansList.innerHTML = '';
    
                        // If we have Skylink plans, display them
                        if (data.plans && data.plans.length > 0) {
                            data.plans.forEach(plan => {
                                // Create a new div for each plan
                                var planDiv = document.createElement('div');
                                planDiv.classList.add('plan');  // Add the "plan" class
    
                                // Set the text content to display the name and code of the plan
                                planDiv.textContent = `${plan.name} - ${plan.code}`;
    
                                // Create the "Subscribe Now" button
                                var subscribeButton = document.createElement('button');
                                subscribeButton.classList.add('button');
                                subscribeButton.id = `subscribe-button-${plan.id}`; // Unique ID for each button
                                subscribeButton.textContent = 'Subscribe Now';
    
                                // Append the plan text and button to the planDiv
                                planDiv.appendChild(subscribeButton);
    
                                // Append the created plan div to the skylinkPlansList container
                                skylinkPlansList.appendChild(planDiv);
                            });
                        } else {
                            skylinkPlansList.textContent = 'No Skylink plans available for this platform.';
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching Skylink plans:', error);
                    });
            } else {
                // Clear the plans if no platform is selected
                document.getElementById('skylinkPlansList').innerHTML = '';
            }
        }
    </script>
    
    
    
</body>
</html>
